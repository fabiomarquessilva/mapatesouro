<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ca√ßa ao Tesouro Pirata</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- Leaflet CSS para o mapa -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzxHlY/QfBoSLzQmFLPsojB8jYM="
        crossorigin=""/>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/4K9stVbLoginGmfExkX/I="
        crossorigin=""></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0fdf4; /* Verde claro para um tema de aventura */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
        }
        #app-container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* Cantos mais arredondados */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        #map {
            height: 300px; /* Altura fixa para o mapa */
            width: 100%;
            border-radius: 0.75rem;
            border: 1px solid #e5e7eb;
        }
        .message-box {
            background-color: #fff7ed;
            border-left: 4px solid #f97316;
            color: #ea580c;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            text-align: left;
        }
        .button-primary {
            background-color: #10b981; /* Verde esmeralda */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .button-primary:hover {
            background-color: #059669;
            transform: translateY(-2px);
        }
        .button-primary:active {
            background-color: #047857;
            transform: translateY(0);
        }
        .button-disabled {
            background-color: #cccccc;
            color: #666666;
            cursor: not-allowed;
        }
        .clue-card {
            background-color: #ecfdf5; /* Verde claro para a pista */
            border: 1px solid #a7f3d0;
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: left;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
        }
        .clue-card h2 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #065f46;
            margin-bottom: 0.75rem;
        }
        .clue-card p {
            font-size: 1.125rem;
            color: #064e3b;
            line-height: 1.6;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #10b981;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Custom arrow icon styling */
        .custom-arrow-icon {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 20px; /* Adjust as needed */
            height: 20px; /* Adjust as needed */
        }
        .custom-arrow-icon div {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 20px solid; /* Color will be set by JS */
            transform-origin: 50% 75%; /* Rotate around its base */
            transition: transform 0.1s linear; /* Smooth rotation */
        }
    </style>
</head>
<body>
    <div id="app-container">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Ca√ßa ao Tesouro Pirata! üè¥‚Äç‚ò†Ô∏è</h1>

        <div id="start-screen">
            <p class="text-lg text-gray-600 mb-6">Prepare-se para uma aventura emocionante! Siga as pistas para encontrar o tesouro escondido.</p>
            <button id="startButton" class="button-primary">Iniciar Ca√ßa ao Tesouro</button>
        </div>

        <div id="game-screen" class="hidden">
            <div id="map"></div>
            <div id="status" class="text-gray-700 text-sm mt-2">Aguardando sua localiza√ß√£o...</div>
            <div id="clue-display" class="clue-card mt-4 hidden">
                <h2 id="clue-title">Pista Atual</h2>
                <p id="clue-text"></p>
                <p id="next-hint" class="text-gray-500 text-sm italic mt-2"></p>
            </div>
            <button id="foundClueButton" class="button-primary mt-4 button-disabled" disabled>Encontrei a Pista!</button>
            <div id="final-message" class="clue-card mt-4 hidden">
                <h2 class="text-2xl font-bold text-green-700">Tesouro Encontrado! üéâ</h2>
                <p class="text-lg text-green-800" id="secret-message"></p>
            </div>
            <div id="error-message" class="message-box hidden"></div>
            <div id="loading-indicator" class="loading-spinner hidden"></div>
        </div>
    </div>

    <script>
        // Game configuration
        const TREASURE_HUNT_CLUES = [
            {
                id: 0,
                latitude: -6.775780, // Pista Churrasqueira
                longitude: -38.240988,
                clueText: "Ol√°, pequena pirata! Sua primeira pista est√° na churrasqueira. Procure por algo brilhante perto do espeto!",
                nextHint: "A pr√≥xima pista est√° onde os carros entram e saem, perto de um port√£o grande.",
                found: false
            },
            {
                id: 1,
                latitude: -6.776213, // Pista Guarita
                longitude: -38.241104,
                clueText: "Muito bem! Voc√™ encontrou a segunda pista na guarita! Agora, volte para a churrasqueira, mas olhe bem de perto, tem outro segredo l√°!",
                nextHint: "A pr√≥xima pista est√° onde a comida fica gostosa e o cheirinho √© bom, perto da churrasqueira de novo!",
                found: false
            },
            {
                id: 2,
                latitude: -6.775925, // Pista Churrasqueira (segunda vez)
                longitude: -38.240842,
                clueText: "Uau, voc√™ √© uma √≥tima ca√ßadora de tesouros! A pen√∫ltima pista est√° na sala de jogos. Procure por algo escondido perto dos brinquedos!",
                nextHint: "A pr√≥xima pista est√° onde a divers√£o acontece, com muitos jogos e risadas.",
                found: false
            },
            {
                id: 3,
                latitude: -6.775893, // Pista Sala de Jogos
                longitude: -38.241062,
                clueText: "Quase l√°! Voc√™ encontrou a pista da sala de jogos! Agora, suba a escada do Bloco C, o tesouro est√° quase √† vista!",
                nextHint: "A pr√≥xima pista est√° onde voc√™ sobe para chegar no seu andar, no Bloco C.",
                found: false
            },
            {
                id: 4,
                latitude: -6.775842, // Pista Escada Bloco C
                longitude: -38.241144,
                clueText: "Excelente! Voc√™ est√° muito perto! A √°rea gourmet te espera com a pr√≥xima pista. Procure por algo que brilha na cozinha!",
                nextHint: "A pr√≥xima pista est√° onde se prepara comidas deliciosas, na √°rea gourmet.",
                found: false
            },
            {
                id: 5,
                latitude: -6.775936, // Pista √Årea Gourmet
                longitude: -38.241007,
                clueText: "Incr√≠vel! A √°rea gourmet revelou seu segredo! Agora, v√° para onde o carro do papai est√° estacionado, o tesouro est√° quase em suas m√£os!",
                nextHint: "A pr√≥xima pista est√° perto do carro grande do papai.",
                found: false
            },
            {
                id: 6,
                latitude: -6.775940, // Pista Carro do Papai
                longitude: -38.241271,
                clueText: "Parab√©ns, aventureira! Voc√™ encontrou a √∫ltima pista! Agora, o tesouro final te espera no lugar mais especial de todos...",
                nextHint: "Volte para o seu apartamento, o segredo final est√° te esperando l√°!",
                found: false
            }
        ];

        const FINAL_SECRET_MESSAGE = "Volte para seu apartamento e d√™ um abra√ßo na mam√£e!";
        // Raio em metros para o bot√£o "Encontrei a Pista!" ficar ativo
        const PROXIMITY_RADIUS_FOR_BUTTON_ACTIVATION = 100; 

        let currentClueIndex = 0;
        let watchId; // Para armazenar o ID do watchPosition
        let map;
        let userMarker;
        let clueMarker;
        let proximityCircle; // Para o c√≠rculo de proximidade
        let directionArrowMarker; // Marcador para a seta direcional
        let lastKnownHeading = 0; // Armazena a √∫ltima dire√ß√£o (b√∫ssola) conhecida do dispositivo
        let isMapInitialized = false; // Flag para rastrear a inicializa√ß√£o do mapa

        // Elementos DOM
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const startButton = document.getElementById('startButton');
        const statusDiv = document.getElementById('status');
        const clueDisplay = document.getElementById('clue-display');
        const clueTitle = document.getElementById('clue-title');
        const clueText = document.getElementById('clue-text');
        const nextHint = document.getElementById('next-hint');
        const foundClueButton = document.getElementById('foundClueButton'); // Novo bot√£o
        const finalMessageDiv = document.getElementById('final-message');
        const secretMessageP = document.getElementById('secret-message');
        const errorMessageDiv = document.getElementById('error-message');
        const loadingIndicator = document.getElementById('loading-indicator');

        // Fun√ß√£o para exibir uma caixa de mensagem
        function showMessageBox(message, type = 'error') {
            errorMessageDiv.textContent = message;
            errorMessageDiv.className = `message-box ${type === 'error' ? 'bg-red-100 border-red-500 text-red-700' : 'bg-blue-100 border-blue-500 text-blue-700'}`;
            errorMessageDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para esconder a caixa de mensagem
        function hideMessageBox() {
            errorMessageDiv.classList.add('hidden');
        }

        // Fun√ß√£o para exibir o indicador de carregamento
        function showLoading() {
            loadingIndicator.classList.remove('hidden');
        }

        // Fun√ß√£o para esconder o indicador de carregamento
        function hideLoading() {
            loadingIndicator.classList.add('hidden');
        }

        // Fun√ß√£o para inicializar o mapa
        function initMap(latitude, longitude) {
            if (map) {
                map.remove(); // Remove o mapa existente, se houver
            }
            map = L.map('map').setView([latitude, longitude], 17); // Vis√£o inicial com zoom
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            userMarker = L.marker([latitude, longitude]).addTo(map)
                .bindPopup("Voc√™ est√° aqui!")
                .openPopup();

            isMapInitialized = true; // Define a flag como true ap√≥s a inicializa√ß√£o do mapa
            // O marcador da pista e o c√≠rculo ser√£o adicionados por displayClue() assim que o mapa estiver pronto
        }

        // Fun√ß√£o para atualizar a posi√ß√£o do marcador do usu√°rio no mapa
        function updateUserMarker(latitude, longitude) {
            if (userMarker) {
                userMarker.setLatLng([latitude, longitude]);
                map.setView([latitude, longitude]); // Mant√©m o mapa centralizado no usu√°rio
            }
        }

        // Fun√ß√£o para atualizar a posi√ß√£o do marcador da pista e o c√≠rculo no mapa
        function updateClueMarkerAndCircle() {
            // Garante que o mapa esteja inicializado antes de adicionar o marcador da pista
            if (!isMapInitialized) {
                return;
            }
            if (clueMarker) {
                map.removeLayer(clueMarker); // Remove o marcador da pista antiga
            }
            if (proximityCircle) {
                map.removeLayer(proximityCircle); // Remove o c√≠rculo antigo
            }

            const targetClue = TREASURE_HUNT_CLUES[currentClueIndex];
            if (targetClue) {
                clueMarker = L.marker([targetClue.latitude, targetClue.longitude]).addTo(map)
                    .bindPopup("Pr√≥xima Pista!")
                    .openPopup();

                // Adiciona o c√≠rculo de proximidade
                proximityCircle = L.circle([targetClue.latitude, targetClue.longitude], {
                    color: 'blue',
                    fillColor: '#30f',
                    fillOpacity: 0.2,
                    radius: PROXIMITY_RADIUS_FOR_BUTTON_ACTIVATION
                }).addTo(map);
            }
        }

        // Fun√ß√£o para calcular a dist√¢ncia entre duas coordenadas (f√≥rmula de Haversine)
        function getDistance(lat1, lon1, lat2, lon2) {
            const R = 6371e3; // metros
            const œÜ1 = lat1 * Math.PI / 180; // œÜ, Œª em radianos
            const œÜ2 = lat2 * Math.PI / 180;
            const ŒîœÜ = (lat2 - lat1) * Math.PI / 180;
            const ŒîŒª = (lon2 - lon1) * Math.PI / 180;

            const a = Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +
                      Math.cos(œÜ1) * Math.cos(œÜ2) *
                      Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            const d = R * c; // em metros
            return d;
        }

        // Fun√ß√£o para calcular o rolamento (bearing) entre dois pontos
        function calculateBearing(lat1, lon1, lat2, lon2) {
            const toRadians = (deg) => deg * Math.PI / 180;
            const toDegrees = (rad) => rad * 180 / Math.PI;

            const œÜ1 = toRadians(lat1);
            const œÜ2 = toRadians(lat2);
            const ŒîŒª = toRadians(lon2 - lon1);

            const y = Math.sin(ŒîŒª) * Math.cos(œÜ2);
            const x = Math.cos(œÜ1) * Math.sin(œÜ2) -
                      Math.sin(œÜ1) * Math.cos(œÜ2) * Math.cos(ŒîŒª);
            let bearing = toDegrees(Math.atan2(y, x));
            return (bearing + 360) % 360; // Normaliza para 0-360
        }

        // Fun√ß√£o para atualizar a dire√ß√£o e a cor da seta
        function updateArrowDirectionAndColor() {
            if (!isMapInitialized || !userMarker || currentClueIndex >= TREASURE_HUNT_CLUES.length) {
                // Mapa n√£o pronto, marcador do usu√°rio n√£o definido ou todas as pistas encontradas
                if (directionArrowMarker) {
                    map.removeLayer(directionArrowMarker);
                    directionArrowMarker = null;
                }
                return;
            }

            const userLatLng = userMarker.getLatLng();
            const currentClue = TREASURE_HUNT_CLUES[currentClueIndex];
            const targetLatLng = L.latLng(currentClue.latitude, currentClue.longitude);

            // Calcula o rolamento do usu√°rio para o alvo
            const bearingToTarget = calculateBearing(
                userLatLng.lat, userLatLng.lng,
                targetLatLng.lat, targetLatLng.lng
            );

            // Calcula o √¢ngulo de rota√ß√£o da seta em rela√ß√£o √† orienta√ß√£o do dispositivo
            // A seta aponta para o alvo, mas sua rota√ß√£o √© relativa √† b√∫ssola do dispositivo
            const rotationAngle = bearingToTarget - lastKnownHeading;

            // Calcula a diferen√ßa angular absoluta para determinar a cor
            let angleDiffAbs = Math.abs(lastKnownHeading - bearingToTarget);
            let normalizedAngleDiff = Math.min(angleDiffAbs, 360 - angleDiffAbs);

            // Determina a cor da seta com base no alinhamento (ex: dentro de +/- 30 graus)
            const isCorrectDirection = normalizedAngleDiff <= 30; // Dentro de 30 graus do alvo
            const arrowColor = isCorrectDirection ? '#10b981' : '#ef4444'; // Verde ou Vermelho

            // Cria ou atualiza o √≠cone personalizado da seta
            const arrowIconHtml = `
                <div style="
                    width: 0;
                    height: 0;
                    border-left: 10px solid transparent;
                    border-right: 10px solid transparent;
                    border-bottom: 20px solid ${arrowColor};
                    transform: rotate(${rotationAngle}deg); /* Gira a seta */
                    transform-origin: 50% 75%; /* Gira em torno de sua base */
                    transition: transform 0.1s linear; /* Rota√ß√£o suave */
                "></div>
            `;

            const customArrowIcon = L.divIcon({
                className: 'custom-arrow-icon',
                html: arrowIconHtml,
                iconSize: [20, 20], // Tamanho da div da seta
                iconAnchor: [10, 20] // Ponto de ancoragem (centro inferior da seta)
            });

            if (!directionArrowMarker) {
                directionArrowMarker = L.marker(userLatLng, { icon: customArrowIcon }).addTo(map);
            } else {
                directionArrowMarker.setLatLng(userLatLng);
                directionArrowMarker.setIcon(customArrowIcon);
            }
        }

        // Manipulador de eventos de orienta√ß√£o do dispositivo (b√∫ssola)
        function handleOrientation(event) {
            // alpha √© a dire√ß√£o da b√∫ssola (0-360 graus, 0 √© Norte)
            if (event.alpha !== null) {
                lastKnownHeading = event.alpha;
                updateArrowDirectionAndColor();
            }
        }

        // Fun√ß√£o para exibir a pista atual
        function displayClue() {
            // Garante que o mapa esteja inicializado antes de exibir pistas que dependem dele
            if (!isMapInitialized) {
                return;
            }

            const clue = TREASURE_HUNT_CLUES[currentClueIndex];
            if (clue) {
                clueTitle.textContent = `Pista ${currentClueIndex + 1}`;
                clueText.textContent = clue.clueText;
                nextHint.textContent = `Dica: ${clue.nextHint}`;
                clueDisplay.classList.remove('hidden');
                foundClueButton.classList.add('button-disabled'); // Desabilita o bot√£o ao exibir nova pista
                foundClueButton.disabled = true;
                updateClueMarkerAndCircle(); // Atualiza o marcador da pista e o c√≠rculo no mapa
                updateArrowDirectionAndColor(); // Atualiza a seta direcional para a nova pista
            } else {
                // Todas as pistas encontradas, exibe a mensagem final
                clueDisplay.classList.add('hidden');
                foundClueButton.classList.add('hidden'); // Esconde o bot√£o
                finalMessageDiv.classList.remove('hidden');
                secretMessageP.textContent = FINAL_SECRET_MESSAGE;
                statusDiv.textContent = "Tesouro Encontrado!";
                if (watchId) {
                    navigator.geolocation.clearWatch(watchId); // Para de observar a localiza√ß√£o
                }
                if (clueMarker) {
                    map.removeLayer(clueMarker); // Remove o marcador da pista
                }
                if (proximityCircle) { // Remove o c√≠rculo de proximidade
                    map.removeLayer(proximityCircle);
                }
                // Remove o marcador da seta direcional quando o jogo termina
                if (directionArrowMarker) {
                    map.removeLayer(directionArrowMarker);
                    directionArrowMarker = null;
                }
                // Remove o listener de orienta√ß√£o do dispositivo
                window.removeEventListener('deviceorientation', handleOrientation);
            }
        }

        // Callback de sucesso para geolocaliza√ß√£o
        function geolocationSuccess(position) {
            hideLoading();
            hideMessageBox();

            const { latitude, longitude, accuracy } = position.coords;
            statusDiv.textContent = `Sua localiza√ß√£o: Lat ${latitude.toFixed(5)}, Lon ${longitude.toFixed(5)} (Precis√£o: ${accuracy.toFixed(1)}m)`;

            // Inicializa o mapa se ainda n√£o foi inicializado
            if (!map) {
                initMap(latitude, longitude);
                // Ap√≥s a inicializa√ß√£o do mapa pela primeira vez, exibe a primeira pista
                displayClue();
            } else {
                updateUserMarker(latitude, longitude);
            }

            // Garante que a seta seja atualizada com a nova posi√ß√£o do usu√°rio
            updateArrowDirectionAndColor();

            // Para atualiza√ß√µes de localiza√ß√£o subsequentes, verifica a proximidade da pista
            const currentClue = TREASURE_HUNT_CLUES[currentClueIndex];
            if (currentClue && !currentClue.found) {
                const distance = getDistance(latitude, longitude, currentClue.latitude, currentClue.longitude);
                statusDiv.textContent += ` | Dist√¢ncia para a pr√≥xima pista: ${distance.toFixed(1)}m`;

                // Ativa/desativa o bot√£o "Encontrei a Pista!"
                if (distance <= PROXIMITY_RADIUS_FOR_BUTTON_ACTIVATION) {
                    foundClueButton.classList.remove('button-disabled');
                    foundClueButton.disabled = false;
                } else {
                    foundClueButton.classList.add('button-disabled');
                    foundClueButton.disabled = true;
                }
            }
        }

        // Callback de erro para geolocaliza√ß√£o
        function geolocationError(error) {
            hideLoading();
            let message = "Erro ao obter a localiza√ß√£o.";
            let troubleshootingTip = "Por favor, verifique se o GPS do seu aparelho est√° ligado, se o navegador tem permiss√£o para acessar sua localiza√ß√£o e tente recarregar a p√°gina.";

            switch (error.code) {
                case error.PERMISSION_DENIED:
                    message = "Permiss√£o de localiza√ß√£o negada. Por favor, habilite a localiza√ß√£o nas configura√ß√µes do seu navegador ou do site.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Informa√ß√µes de localiza√ß√£o indispon√≠veis. O sinal de GPS pode estar fraco ou bloqueado.";
                    break;
                case error.TIMEOUT:
                    message = "Tempo limite excedido ao tentar obter a localiza√ß√£o. O sinal pode estar demorando muito para ser obtido.";
                    break;
                case error.UNKNOWN_ERROR:
                    message = "Ocorreu um erro desconhecido ao tentar obter a localiza√ß√£o.";
                    break;
            }
            showMessageBox(`${message} ${troubleshootingTip}`);
            statusDiv.textContent = message;
        }

        // Fun√ß√£o para ativar a pr√≥xima pista manualmente
        function activateClueManually() {
            const currentClue = TREASURE_HUNT_CLUES[currentClueIndex];
            if (currentClue && !currentClue.found) {
                // Poder√≠amos adicionar uma verifica√ß√£o de proximidade aqui novamente,
                // mas como o bot√£o s√≥ ativa perto, a confian√ßa √© maior.
                currentClue.found = true;
                showMessageBox(`Pista ${currentClueIndex + 1} encontrada!`, 'info');
                setTimeout(() => {
                    hideMessageBox();
                    currentClueIndex++;
                    displayClue(); // Exibe a pr√≥xima pista ou a mensagem final
                }, 1500); // Exibe a mensagem por 1.5 segundos
            }
        }

        // Inicia a ca√ßa ao tesouro
        startButton.addEventListener('click', () => {
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            showLoading();

            if (navigator.geolocation) {
                watchId = navigator.geolocation.watchPosition(
                    geolocationSuccess,
                    geolocationError,
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );

                // Solicita permiss√£o para DeviceOrientationEvent em iOS 13+
                if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                    DeviceOrientationEvent.requestPermission()
                        .then(permissionState => {
                            if (permissionState === 'granted') {
                                window.addEventListener('deviceorientation', handleOrientation);
                            } else {
                                showMessageBox("Permiss√£o de orienta√ß√£o do dispositivo negada. A seta direcional n√£o funcionar√°.", 'info');
                            }
                        })
                        .catch(error => {
                            console.error("Erro ao solicitar permiss√£o de orienta√ß√£o:", error);
                            showMessageBox("Erro ao solicitar permiss√£o de orienta√ß√£o do dispositivo. A seta direcional pode n√£o funcionar.", 'error');
                        });
                } else {
                    // Para navegadores que n√£o s√£o iOS 13+ ou vers√µes mais antigas do Safari
                    window.addEventListener('deviceorientation', handleOrientation);
                }

            } else {
                showMessageBox("Seu navegador n√£o suporta geolocaliza√ß√£o. Por favor, use um navegador compat√≠vel.");
                hideLoading();
            }
        });

        // Adiciona o listener para o novo bot√£o
        foundClueButton.addEventListener('click', activateClueManually);

        // Configura√ß√£o inicial ao carregar a janela
        window.onload = () => {
            // O mapa ser√° carregado quando o GPS for obtido pela primeira vez
        };
    </script>
</body>
</html>
